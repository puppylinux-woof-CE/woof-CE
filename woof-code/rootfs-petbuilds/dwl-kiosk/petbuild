download() {
    [ -f dwl-05f4e23c43aa0d6e8fb8673a3b0d71653dc6dbbd.zip ] || wget -t 3 -T 60 -O dwl-05f4e23c43aa0d6e8fb8673a3b0d71653dc6dbbd.zip https://github.com/djpohly/dwl/archive/05f4e23c43aa0d6e8fb8673a3b0d71653dc6dbbd.zip
    [ -f wlroots-88897e69a3da8bf8b73067967ae63cd05d32bc67.tar.gz ] || wget -t 3 -T 60 -O wlroots-88897e69a3da8bf8b73067967ae63cd05d32bc67.tar.gz https://gitlab.freedesktop.org/wlroots/wlroots/-/archive/88897e69a3da8bf8b73067967ae63cd05d32bc67/wlroots-88897e69a3da8bf8b73067967ae63cd05d32bc67.tar.gz
}

build() {
    tar -xzf wlroots-88897e69a3da8bf8b73067967ae63cd05d32bc67.tar.gz
    cd wlroots-88897e69a3da8bf8b73067967ae63cd05d32bc67
    meson --buildtype=release --prefix=/opt/wlroots --default-library=static -Dbackends=drm,libinput -Dexamples=false build
    ninja -C build install
    cd ..

    unzip dwl-05f4e23c43aa0d6e8fb8673a3b0d71653dc6dbbd.zip
    cd dwl-05f4e23c43aa0d6e8fb8673a3b0d71653dc6dbbd
    patch -p1 < ../dwl-kiosk.patch
    sed -e s/^#XWAYLAND/XWAYLAND/ -e s/^#XLIBS/XLIBS/ -i config.mk
    cp -f ../config.h .
    PKG_CONFIG_PATH=`find /opt/wlroots -name pkgconfig -type d` make install PREFIX=/usr

    $CC $CFLAGS ../dwl-send.c $LDFLAGS -o /usr/bin/dwl-send
    $CC $CFLAGS ../dwl-status.c $LDFLAGS -o /usr/bin/dwl-status

    rm -rf /opt/wlroots
}